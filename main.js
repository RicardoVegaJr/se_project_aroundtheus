!function(){"use strict";class e{constructor(e,t,o){let{name:s,link:n}=e;this._name=s,this._link=n,this._cardSelector=t,this._handleImageClick=o}_setEventListeners(){this._cardElement.querySelector(".card-heart").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector(".card-image").addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleDeleteCard(){this._cardElement.remove()}_handleLikeIcon(){this._cardElement.querySelector(".card-heart").classList.toggle("card-heart_active")}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card-image"),this._cardTitleEl=this._cardElement.querySelector(".card-title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=`Photo of ${this._name}`,this._cardTitleEl.textContent=this._name,this._setEventListeners(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_foundInvalid(){return!this._inputEls.every((e=>e.validity.valid))}toggleButtonState(){this._foundInvalid()?this._disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault(),this._disableButton()})),this._setEventListeners(this._formEl)}};class o{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeModalButton=this._popupElement.querySelector(".modal__close")}openModal(){this._popupElement.classList.add("modal_opened"),this.setEventListeners()}closeModal(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscButton),document.removeEventListener("click",this._handleOverlayClose),this._closeModalButton.removeEventListener("click",this._handleClickButtonClose)}_handleEscButton=e=>{"Escape"===e.key&&(console.log("esc pressed"),this.closeModal())};_handleOverlayClose=e=>{e.target.classList.contains("modal_opened")&&this.closeModal()};_handleClickButtonClose=()=>{this.closeModal()};setEventListeners(){document.addEventListener("keyup",this._handleEscButton),document.addEventListener("click",this._handleOverlayClose),this._closeModalButton.addEventListener("click",this._handleClickButtonClose)}}class s extends o{constructor(e){let{popupSelector:t,handleFormSubmit:o}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=o}closeModal(){this._popupForm.reset(),super.closeModal(),this._popupForm.removeEventListener("submit",this._handleFormSubmitButton)}_handleFormSubmitButton=e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())};setEventListeners(){this._popupForm.addEventListener("submit",this._handleFormSubmitButton),super.setEventListeners()}_getInputValues(){const e=[...this._popupForm.querySelectorAll(".input")],t={};for(const o of e)t[o.name]=o.value;return t}}const n=[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],r=document.querySelector("#profileModal"),l=(document.querySelector("#modalProfileClose"),document.querySelector("#contentModal"),document.querySelector("#content__add-button-action")),i=(document.querySelector("#modalContentClose"),document.querySelector("#modalprofileform")),a=document.querySelector("#modalcontentform"),c=i.querySelector("#name"),u=i.querySelector("#title"),d=(document.querySelector("#profilename"),document.querySelector("#profilejob"),document.querySelector("#modalsubmit"),document.querySelector(".cards"),document.querySelector("#card-template").content.firstElementChild,a.querySelector(".modal__edit_title"),a.querySelector(".modal__edit_url"),document.querySelector("#modalPreviewClose"),new s({popupSelector:"#contentModal",handleFormSubmit:function(e){E({name:e.title,link:e.url}),d.closeModal()}})),m=new s({popupSelector:"#profileModal",handleFormSubmit:function(e){p.setUserInfo(e),m.closeModal()}}),h=new class extends o{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._imagePreview=document.querySelector(".modal__preview-image"),this._modalImageText=document.querySelector(".modal__preview-title")}openModal(e){let{name:t,link:o}=e;this._imagePreview.src=o,this._imagePreview.alt=`Photo of ${t}`,this._modalImageText.textContent=t,super.openModal()}closeModal(){super.closeModal()}}({popupSelector:".js-preview-popup"}),_=new class{constructor(e,t,o){let{items:s}=e;this._items=s,this._renderer=t,this._container=document.querySelector(o)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:n},E,"#section");_.renderItems(n);const p=new class{constructor(e,t){this.nameEl=document.querySelector(e),this.aboutEl=document.querySelector(t)}getUserInfo(){return{name:this.nameEl.textContent,job:this.aboutEl.textContent}}setUserInfo(e){this.nameEl.textContent=e.name,this.aboutEl.textContent=e.about}}("#profilename","#profilejob");function E(t){const o=new e(t,"#card-template",S);_.addItem(o.getView())}function S(e){console.log(e),h.openModal(e)}document.querySelector("#profile__edit-button-action").addEventListener("click",(()=>{const e=p.getUserInfo();c.value=e.name,u.value=e.job,y.toggleButtonState(),m.openModal()})),l.addEventListener("click",(()=>{y.toggleButtonState(),d.openModal()}));const v={formSelector:".modal__form",inputSelector:".modal__edit",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:".modal__error",errorClass:".modal__error_visible"};new t(v,r).enableValidation();const y=new t(v,a);y.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixTQUFTLEtBRzFDLE1BQU1xSCxFQUFPdkIsRUFBWXFCLGNBQ3pCOUIsRUFBVU4sTUFBUXNDLEVBQUsvSCxLQUN2QmdHLEVBQVNQLE1BQVFzQyxFQUFLRCxJQUN0QkksRUFBa0JqRixvQkFDbEJzRCxFQUFpQnZDLFdBQVcsSUFhOUI0QixFQUFpQmxGLGlCQUFpQixTQUFTLEtBQ3pDd0gsRUFBa0JqRixvQkFDbEJnRCxFQUFhakMsV0FBVyxJQW1EMUIsTUFBTXZDLEVBQVMsQ0FPYjBHLGFBQWMsZUFDZHZHLGNBQWUsZUFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLGdCQUNqQkUsV0FBWSx5QkFRZSxJQUFJZ0csRUFBYzNHLEVBQVFrRSxHQUNsQ2pDLG1CQUVyQixNQUFNd0UsRUFBb0IsSUFBSUUsRUFBYzNHLEVBQVFxRSxHQUNwRG9DLEVBQWtCeEUsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvc2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBvcGVuTW9kYWwsIGNsb3NlTW9kYWwgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuLy8gaW1wb3J0IHtcclxuLy8gICBwcmV2aWV3SW1hZ2VNb2RhbFdpbmRvdyxcclxuLy8gICBwcmV2aWV3SW1hZ2VFbGVtZW50LFxyXG4vLyAgIG1vZGFsUHJldmlld0Nsb3NlQnV0dG9uLFxyXG4vLyAgIG1vZGFsUHJldmlld1RpdGxlLFxyXG4vLyB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG4vLyBpbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgbGluayB9LCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICB9XHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gLS0tLSBjYXJkIGxpa2UgYnV0dG9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZC1oZWFydFwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tIGNhcmQgZGVsZXRlIGJ1dHRvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcclxuICAgICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkLWltYWdlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIC8vIHRoaXMuX3ByZXZpZXdJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5saW5rO1xyXG4gICAgICAgIC8vIHRoaXMuX3ByZXZpZXdJbWFnZUVsZW1lbnQuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5uYW1lfWA7XHJcbiAgICAgICAgLy8gdGhpcy5fbW9kYWxQcmV2aWV3VGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmQtaGVhcnRcIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkLWhlYXJ0X2FjdGl2ZVwiKTtcclxuICB9XHJcbiAgZ2V0VmlldygpIHtcclxuICAgIC8vIC0tLS0gZ2V0IHRoZSBjYXJkIHZpZXcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmQtdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgLy8gLS0tLSBzZXQgZXZlbnQgbGlzdGVuZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIC8vIC0tLS0gcmV0dXJuIHRoZSBjYXJkIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWwpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcclxuICB9XHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICAvLyBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgLy8gICBsZXQgZm91bmRJbnZhbGlkID0gZmFsc2U7XHJcblxyXG4gIC8vICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gIC8vICAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAvLyAgICAgICBmb3VuZEludmFsaWQgPSB0cnVlO1xyXG4gIC8vICAgICB9XHJcbiAgLy8gICB9KTtcclxuXHJcbiAgLy8gICBpZiAoZm91bmRJbnZhbGlkKSB7XHJcbiAgLy8gICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIC8vICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIC8vICAgfSBlbHNlIHtcclxuICAvLyAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgLy8gICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIC8vICAgfVxyXG4gIC8vIH1cclxuICBfZm91bmRJbnZhbGlkKCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVscy5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgLy8gbGV0IGZvdW5kSW52YWxpZCA9IGZhbHNlO1xyXG5cclxuICAgIGlmICh0aGlzLl9mb3VuZEludmFsaWQoKSkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgfVxyXG5cclxuICAvLyBfY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbCwgb3B0aW9ucykge1xyXG4gIC8vICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgLy8gICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgb3B0aW9ucyk7XHJcbiAgLy8gICB9IGVsc2Uge1xyXG4gIC8vICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIG9wdGlvbnMpO1xyXG4gIC8vICAgfVxyXG4gIC8vIH1cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyh0aGlzLl9mb3JtRWwpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcigpO1xyXG4vLyBlZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBjb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRNb2RhbCk7XHJcbi8vIHByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vIGNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBjb250ZW50Rm9ybUVsZW1lbnQpO1xyXG4vLyBjYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBjb25zdCBjb25maWcgPSB7XHJcbi8vICAgLy8gICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbi8vICAgLy8gICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuLy8gICAvLyAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXHJcbi8vICAgLy8gICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuLy8gICAvLyAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4vLyAgIC8vICAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4vLyAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuLy8gICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZWRpdFwiLFxyXG4vLyAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbi8vICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbi8vICAgaW5wdXRFcnJvckNsYXNzOiBcIi5tb2RhbF9fZXJyb3JcIixcclxuLy8gICBlcnJvckNsYXNzOiBcIi5tb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4vLyB9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VNb2RhbEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICB9XHJcbiAgb3Blbk1vZGFsKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIGNsb3NlTW9kYWwoKSB7XHJcbiAgICAvL2Nsb3NlIHBvcHVwXHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NCdXR0b24pO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZSk7XHJcbiAgICB0aGlzLl9jbG9zZU1vZGFsQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIFwiY2xpY2tcIixcclxuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tCdXR0b25DbG9zZVxyXG4gICAgKTtcclxuICB9XHJcbiAgX2hhbmRsZUVzY0J1dHRvbiA9IChldmVudCkgPT4ge1xyXG4gICAgLy9lc2NcclxuICAgIGNvbnN0IGtleSA9IGV2ZW50LmtleTtcclxuICAgIGlmIChrZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJlc2MgcHJlc3NlZFwiKTtcclxuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBfaGFuZGxlT3ZlcmxheUNsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgX2hhbmRsZUNsaWNrQnV0dG9uQ2xvc2UgPSAoKSA9PiB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwoKTtcclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0J1dHRvbik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcclxuICAgIHRoaXMuX2Nsb3NlTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgXCJjbGlja1wiLFxyXG4gICAgICB0aGlzLl9oYW5kbGVDbGlja0J1dHRvbkNsb3NlXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG4gIGNsb3NlTW9kYWwoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlTW9kYWwoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXRCdXR0b24pO1xyXG4gIH1cclxuICBfaGFuZGxlRm9ybVN1Ym1pdEJ1dHRvbiA9IChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICB9O1xyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdEJ1dHRvbik7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIC8vIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXRCdXR0b24pO1xyXG4gIH1cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaW5wdXRcIildO1xyXG5cclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgZm9yIChjb25zdCBpbnB1dCBvZiBpbnB1dExpc3QpIHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH1cclxuICAgIC8vIGNvbnNvbGUubG9nKGlucHV0VmFsdWVzKTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcbiAgLy8gdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgLy8gICB0aGlzLl9tb2RhbFN1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gIC8vICAgICBcIiNtb2RhbENvbnRlbnRTdWJtaXRcIlxyXG4gIC8vICAgKTtcclxuICAvLyAgIHRoaXMuX21vZGFsU3VibWl0QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAvLyB9XHJcbn1cclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbi8vIGltcG9ydCB7IG9wZW5Nb2RhbCwgY2xvc2VNb2RhbCB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9zZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5cclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcblxyXG4vLyBzZXRUaW1lb3V0KCgpID0+IHtcclxuLy8gICBwcm9maWxlQ2FyZFBvcHVwLmNsb3NlTW9kYWwoKTtcclxuLy8gfSwgMzAwMCk7XHJcblxyXG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuLy8gICB9LFxyXG4vLyBdO1xyXG5cclxuY29uc3QgY2FyZERhdGEgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuLy8gY29uc3QgY2FyZCA9IG5ldyBDYXJkKGNhcmREYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG4vLyBjYXJkLmdldFZpZXcoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVNb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbENsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbFByb2ZpbGVDbG9zZVwiKTtcclxuY29uc3QgY29udGVudE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb250ZW50TW9kYWxcIik7XHJcbmNvbnN0IGNvbnRlbnRBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbnRlbnRfX2FkZC1idXR0b24tYWN0aW9uXCIpO1xyXG5jb25zdCBjb250ZW50QWRkTW9kYWxDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxDb250ZW50Q2xvc2VcIik7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFscHJvZmlsZWZvcm1cIik7XHJcbmNvbnN0IGNvbnRlbnRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxjb250ZW50Zm9ybVwiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZUZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZVwiKTtcclxuY29uc3Qgam9iSW5wdXQgPSBwcm9maWxlRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiN0aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVuYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlam9iXCIpO1xyXG5jb25zdCBtb2RhbFN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxzdWJtaXRcIik7XHJcbmNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPVxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5jb25zdCBjYXJkVGl0bGVJbnB1dCA9IGNvbnRlbnRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19lZGl0X3RpdGxlXCIpO1xyXG5jb25zdCBjYXJkVXJsSW5wdXQgPSBjb250ZW50Rm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZWRpdF91cmxcIik7XHJcbi8vIGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5qcy1wcmV2aWV3LXBvcHVwXCIpO1xyXG4vLyBjb25zdCBwcmV2aWV3SW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcclxuY29uc3QgbW9kYWxQcmV2aWV3Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsUHJldmlld0Nsb3NlXCIpO1xyXG4vLyBjb25zdCBtb2RhbFByZXZpZXdUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctdGl0bGVcIik7XHJcblxyXG4vLyBjYXJkRGF0YS5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbi8vICAgcmVuZGVyQ2FyZChjYXJkKTtcclxuLy8gfSk7XHJcblxyXG4vLyBtb2RhbFByZXZpZXdDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4vLyAgIGNsb3NlTW9kYWwocHJldmlld0ltYWdlTW9kYWxXaW5kb3cpO1xyXG4vLyB9KTtcclxuXHJcbi8vIGZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4vLyAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbi8vICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUVzY0J1dHRvbik7XHJcbi8vICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbG9zZSk7XHJcbi8vIH1cclxuXHJcbi8vIGZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuLy8gICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4vLyAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVFc2NCdXR0b24pO1xyXG4vLyAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVPdmVybGF5Q2xvc2UpO1xyXG4vLyB9XHJcblxyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjY29udGVudE1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQ2FyZEZvcm1TdWJtaXQsXHJcbn0pO1xyXG5cclxuY29uc3QgcHJvZmlsZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlTW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCxcclxufSk7XHJcblxyXG5jb25zdCBjb250ZW50Q2FyZFByZXZpZXcgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiLmpzLXByZXZpZXctcG9wdXBcIixcclxufSk7XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHsgaXRlbXM6IGNhcmREYXRhIH0sIHJlbmRlckNhcmQsIFwiI3NlY3Rpb25cIik7XHJcbmNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmREYXRhKTtcclxuXHJcbmNvbnN0IG5ld1VzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiI3Byb2ZpbGVuYW1lXCIsIFwiI3Byb2ZpbGVqb2JcIik7XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChjYXJkRGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBoYW5kbGVJbWFnZUNsaWNrKTtcclxuICAvLyBjYXJkTGlzdEVsLnByZXBlbmQoY2FyZEVsZW1lbnQuZ2V0VmlldygpKTtcclxuICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50LmdldFZpZXcoKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcclxuICBjb25zb2xlLmxvZyhjYXJkRGF0YSk7XHJcbiAgY29udGVudENhcmRQcmV2aWV3Lm9wZW5Nb2RhbChjYXJkRGF0YSk7XHJcbn1cclxuXHJcbi8vIC0tLS0gUHJvZmlsZSBNb2RhbCBvcGVuIGFuZCBjbG9zZSBldmVudCBsaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGVfX2VkaXQtYnV0dG9uLWFjdGlvblwiXHJcbik7XHJcblxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIC8vIG5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIC8vIGpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcclxuICBjb25zdCBkYXRhID0gbmV3VXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBkYXRhLm5hbWU7XHJcbiAgam9iSW5wdXQudmFsdWUgPSBkYXRhLmpvYjtcclxuICBjYXJkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIHByb2ZpbGVDYXJkUG9wdXAub3Blbk1vZGFsKCk7XHJcbn0pO1xyXG5cclxuLy8gcHJvZmlsZUVkaXRNb2RhbENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4vLyAgIHByb2ZpbGVDYXJkUG9wdXAuY2xvc2VNb2RhbCgpXHJcbi8vICk7XHJcblxyXG4vLyBtb2RhbFByZXZpZXdDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuLy8gICBjb250ZW50Q2FyZFByZXZpZXcuY2xvc2VNb2RhbCgpXHJcbi8vICk7XHJcblxyXG4vLyAtLS0tIC8vQ29udGVudCBNb2RhbCBvcGVuIGFuZCBjbG9zZSBldmVudCBsaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmNvbnRlbnRBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjYXJkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIG5ld0NhcmRQb3B1cC5vcGVuTW9kYWwoKTtcclxufSk7XHJcbi8vIGNvbnRlbnRBZGRNb2RhbENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBuZXdDYXJkUG9wdXAuY2xvc2VNb2RhbCgpKTtcclxuXHJcbi8vIC0tLS0gLy9Fc2MgQnV0dG9uIE1vZGFsIENsb3NlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8gZnVuY3Rpb24gaGFuZGxlRXNjQnV0dG9uKGV2ZW50KSB7XHJcbi8vICAgY29uc3Qga2V5ID0gZXZlbnQua2V5O1xyXG4vLyAgIGlmIChrZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuLy8gICAgIGNvbnN0IG9wZW5lZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbi8vICAgICBjbG9zZU1vZGFsKG9wZW5lZFBvcHVwKTtcclxuLy8gICB9XHJcbi8vIH1cclxuLy8gLy9PdmVybGF5IE1vZGFsIENsb3NlXHJcbi8vIGZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcclxuLy8gICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcclxuLy8gICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbi8vICAgfVxyXG4vLyB9XHJcblxyXG4vLyBjb25zdCBzdWJtaXRCdXR0b25FdmVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcblxyXG4vLyBzdWJtaXRCdXR0b25FdmVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XHJcbi8vICAgbmV3VXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4vLyAgICAgbmFtZTogbmFtZUlucHV0LnZhbHVlLFxyXG4vLyAgICAgYWJvdXQ6IGpvYklucHV0LnZhbHVlLFxyXG4vLyAgIH0pXHJcbi8vICk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xyXG4gIC8vIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZUlucHV0LnZhbHVlO1xyXG4gIC8vIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBqb2JJbnB1dC52YWx1ZTtcclxuICAvLyBuZXdVc2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgLy8gICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxyXG4gIC8vICAgYWJvdXQ6IGlucHV0VmFsdWVzLmpvYixcclxuICAvLyB9KTtcclxuICBuZXdVc2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcyk7XHJcbiAgcHJvZmlsZUNhcmRQb3B1cC5jbG9zZU1vZGFsKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGNhcmRWYWx1ZXMpIHtcclxuICBjb25zdCBuYW1lID0gY2FyZFZhbHVlcy50aXRsZTtcclxuICBjb25zdCBsaW5rID0gY2FyZFZhbHVlcy51cmw7XHJcbiAgcmVuZGVyQ2FyZCh7IG5hbWUsIGxpbmsgfSwgY2FyZExpc3RFbCk7XHJcbiAgLy8gY29udGVudEZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgLy8gY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbENvbnRlbnRTdWJtaXRcIik7XHJcbiAgLy8gc3VibWl0QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIpO1xyXG4gIC8vIHN1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcInRydWVcIik7XHJcbiAgbmV3Q2FyZFBvcHVwLmNsb3NlTW9kYWwoKTtcclxufVxyXG5cclxuY29uc3QgY29uZmlnID0ge1xyXG4gIC8vICAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxyXG4gIC8vICAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgLy8gICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gIC8vICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgLy8gICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAvLyAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2VkaXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCIubW9kYWxfX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCIubW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbi8vIHByb2ZpbGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuLy8gY29udGVudEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xyXG5cclxuLy8gaW5pdGlhbENhcmRzLmZvckVhY2goKGNhcmREYXRhKSA9PiByZW5kZXJDYXJkKGNhcmREYXRhLCBjYXJkTGlzdEVsKSk7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRNb2RhbCk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBjb250ZW50Rm9ybUVsZW1lbnQpO1xyXG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2ltYWdlUHJldmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctdGl0bGVcIik7XHJcbiAgfVxyXG4gIG9wZW5Nb2RhbCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5faW1hZ2VQcmV2aWV3LnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZVByZXZpZXcuYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZVRleHQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3Blbk1vZGFsKCk7XHJcbiAgfVxyXG4gIGNsb3NlTW9kYWwoKSB7XHJcbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMgfSwgcmVuZGVyZXIsIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIC8vcmVuZGVycyBhbGwgZWxlbWVudHMgb24gdGhlIHBhZ2UuIEl0IHNob3VsZCBpdGVyYXRlIHRocm91Z2ggdGhlIGl0ZW1zIGFycmF5IGFuZCBjYWxsIHRoZSByZW5kZXJlcigpXHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGFkZEl0ZW0oaXRlbXMpIHtcclxuICAgIC8vdGFrZXMgRE9NIEVsIGFuZCBhZGRzIGl0IHRvIHRoZSBjb250YWluZXIuIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhZGRpbmcgYW4gaW5kaXZpZHVhbCBjYXJkIHRvIHRoZSBkb21cclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW1zKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5uYW1lRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmFib3V0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFib3V0U2VsZWN0b3IpO1xyXG4gIH1cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7IG5hbWU6IHRoaXMubmFtZUVsLnRleHRDb250ZW50LCBqb2I6IHRoaXMuYWJvdXRFbC50ZXh0Q29udGVudCB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgLy93aGljaCB0YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IHRvIHRoZSBwYWdlLiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCBhZnRlciBzdWNjZXNzZnVsIHN1Ym1pc3Npb24gb2YgdGhlIHByb2ZpbGUgZm9ybS5cclxuICAgIHRoaXMubmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5hYm91dEVsLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VJY29uIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJyZW1vdmUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJnZXRWaWV3IiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRJbWFnZUVsIiwiX2NhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJjb25maWciLCJmb3JtRWwiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9mb3VuZEludmFsaWQiLCJfaW5wdXRFbHMiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9kaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9oaWRlSW5wdXRFcnJvciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VNb2RhbEJ1dHRvbiIsIm9wZW5Nb2RhbCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQnV0dG9uIiwiX2hhbmRsZU92ZXJsYXlDbG9zZSIsIl9oYW5kbGVDbGlja0J1dHRvbkNsb3NlIiwiZXZlbnQiLCJrZXkiLCJjb25zb2xlIiwibG9nIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwicmVzZXQiLCJfaGFuZGxlRm9ybVN1Ym1pdEJ1dHRvbiIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0TGlzdCIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImNhcmREYXRhIiwicHJvZmlsZUVkaXRNb2RhbCIsImNvbnRlbnRBZGRCdXR0b24iLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJjb250ZW50Rm9ybUVsZW1lbnQiLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsIm5ld0NhcmRQb3B1cCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2FyZFZhbHVlcyIsInJlbmRlckNhcmQiLCJ0aXRsZSIsInVybCIsInByb2ZpbGVDYXJkUG9wdXAiLCJuZXdVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiY29udGVudENhcmRQcmV2aWV3IiwiX2ltYWdlUHJldmlldyIsIl9tb2RhbEltYWdlVGV4dCIsIl9yZWYyIiwiY2FyZFNlY3Rpb24iLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJuYW1lU2VsZWN0b3IiLCJhYm91dFNlbGVjdG9yIiwibmFtZUVsIiwiYWJvdXRFbCIsImdldFVzZXJJbmZvIiwiam9iIiwiZGF0YSIsImFib3V0IiwiY2FyZEVsZW1lbnQiLCJjYXJkRm9ybVZhbGlkYXRvciIsImZvcm1TZWxlY3RvciIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9